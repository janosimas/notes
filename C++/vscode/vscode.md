# VSCode for C++ prototyping

- [Installation](#installation)
- [Extensions](#extensions)
  * [C++](#c--)
  * [Debug](#debug)
  * [Project management](#project-management)
  * [Git](#git)
  * [Other](#other)
- [Prototyping](#prototyping)
  * [Building](#building)
    + [MSVC C++17](#msvc-c17)
    + [MSVC C++03](#msvc-c03)
    + [Clang C++17](#clang-c17)
    + [Clang C++03](#clang-c03)
  * [Executing and debug](#executing-and-debug)
- [Building projects](#building-projects)


# Installation

  [**VSCode**](https://code.visualstudio.com/download) can be installed in 3 different ways: in the user folder (recomended by **Microsoft**), system wide or [portable](https://code.visualstudio.com/docs/editor/portable).

  Each installation mode has it's advantages, if you have a very specific need and always uses **VSCode** for the same function, go with the user folder installation.

  In case you develop with more then one language or has other needs, like Docker or database management, go with portable installation.
  The portable installation allows you to keep your extensions independent and avoid having too many extensions.

  Too many extensions can lag your **VSCode** and are very hard to manage.

# Extensions

## C++

### [C/C++ (Microsoft)](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools)

  The **Microsoft** extension is the minimum one need to use C++.
  It works fairly well but you'll need some work to set it up properly for anything more than a "folder project".

  In **Windows** you may also need to configure the compiler path for different architectures.

### [Clangd (LLVM)](https://marketplace.visualstudio.com/items?itemName=llvm-vs-code-extensions.vscode-clangd)

  The official **LLVM** extension for **clangd** provides alternatives and extra tools for the Microsoft one.

  The extesion can be set up by:
  1. *compile_commands.json*
      - Can be generated by *CMake* or *Visual Studio*
  2. manual configuration
      - Easy for the simple case
      - Complex with a lot of files for anything else

<details>
<summary> Clangd setup </summary>

  1. You need [Clang (9+)](http://releases.llvm.org/download.html) installed and available in your path.

  2. Add the settings  to disable the conflicts with MS extension:

 ```json
  "C_Cpp.autocomplete": "Disabled",
  "C_Cpp.formatting": "Disabled",
  "C_Cpp.errorSquiggles": "Disabled",
  "C_Cpp.intelliSenseEngine": "Disabled",
  "clangd.arguments": [
    "-clang-tidy-checks=-*,modernize-use-override",
    "--suggest-missing-includes",
    "--header-insertion=iwyu"
  ],
```

  3. [Optional] When using manual configuration, create a file with the compilation flags: [compile_flags.txt](compile_flags.txt)
</details>

### [Flylint](https://marketplace.visualstudio.com/items?itemName=jbenden.c-cpp-flylint)

  Flylint (C/C++ Advanced Lint) is an extension that integrates other tools in your `VSCode` to provide code analysis.

  It can be integrated with `clang` and `cppcheck` with minimum effort.

  The `clang` option should be disabled if your are using other `clang-based  extension like `clangd`

<details>
<summary> Sample configuration </summary>

```json
"c-cpp-flylint.cppcheck.executable": "C:\\Program Files\\Cppcheck\\cppcheck.exe",
"c-cpp-flylint.flexelint.enable": false,
"c-cpp-flylint.clang.enable": true,
"c-cpp-flylint.clang.extraArgs": [
    "-Weverything",
    "-std=c++17",
    "-Wno-unused-macros",
    "-Wno-c++-compat"
],
"c-cpp-flylint.clang.includePaths": [
    "C:/Program Files (x86)/Microsoft Visual Studio/2019/Professional/VC/Tools/MSVC/14.22.27905/include",
],
```
</details>

### [Code Runner](https://marketplace.visualstudio.com/items?itemName=formulahendry.code-runner)

  Simple extension for building and executing a single file. Works with a lot of languages out of the box, with C++ you may need to tweak a little the command.
</details>

## Debug

### [C++ Set next statement](https://marketplace.visualstudio.com/items?itemName=ntoskrnl7.cxx-set-next-statement-extension)

  Debug super powers: Can jump the debbuger to a different line.

## Project management

### [CMake](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cmake-tools)

  The **CMake** extension is very mature and full featured. Automatic recognizes *CMakeList* files and configure the project.

### [Solution explorer](https://marketplace.visualstudio.com/items?itemName=fernandoescolar.vscode-solution-explorer)

  This unofficial extension has minimal features, you can open a project and navigate but not much more. One can create a file but filters do not work very well, it works better with folders. **No compilation.**

## Git

### [GitLens](https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens)

  Git super powers. Has more features than most git gui. In line blame, line history, search, you name it. More options than you can manage but don't worry, it works very well with the defaults.

### [Git Graph](https://marketplace.visualstudio.com/items?itemName=mhutchie.git-graph)

  The usual visualizer for the git branches. It's quite usefull for an overview of the git branches or for searching.

## Other

### [Doxygen Documentation Generator](https://marketplace.visualstudio.com/items?itemName=cschlosser.doxdocgen)

  Auto generates skeleton documentation with arguments for functions and templates.

### [Auto Comment Blocks](https://marketplace.visualstudio.com/items?itemName=kevinkyang.auto-comment-blocks)

  Minor improvement for writing documentation blocks, will auto insert '*' when you break a line.

### [Better Readability](https://marketplace.visualstudio.com/items?itemName=pinage404.better-readability-extension-pack)

  Pack of extensions to improve readabillity. Will help bracket matching, colorize the indentation and mark text gremlins for example.

# Prototyping

- [Building](#building)
  * [MSVC C++17](#msvc-c17)
  * [MSVC C++03](#msvc-c03)
  * [Clang C++17](#clang-c17)
  * [Clang C++03](#clang-c03)
- [Executing and debug](#executing-and-debug)

## Building
  These tasks allow you to build the current file with the desired compiler, add them as needed to your *tasks.json*. The binary will be create in the `out/` folder.

  Keybinding to build the current file: `ctrl+f7`

### MSVC C++17
```json
{
    "label": "MSVC C++17",
    "type": "shell",
    "command": "cl.exe",
    "args": [
        "/EHsc",
        "/FC",
        "/Od",
        "/permissive-",
        "/std:c++17",
        "/W4",
        "/Z7",
        "/Fdout/${fileBasenameNoExtension}.pdb",
        "/Feout/${fileBasenameNoExtension}.exe",
        "/Foout/${fileBasenameNoExtension}.obj",
        "${file}"
    ],
    "group": "build",
    "presentation": {
        "reveal":"always"
    },
    "problemMatcher": "$msCompile"
}
```

### MSVC C++03
```json
{
    "label": "MSVC C++03",
    "type": "shell",
    "command": "cl.exe",
    "args": [
        "/EHsc",
        "/FC",
        "/Od",
        "/permissive-",
        "/W4",
        "/Z7",
        "/Fdout/${fileBasenameNoExtension}.pdb",
        "/Feout/${fileBasenameNoExtension}.exe",
        "/Foout/${fileBasenameNoExtension}.obj",
        "${file}"
    ],
    "group": "build",
    "presentation": {
        "reveal":"always"
    },
    "problemMatcher": "$msCompile"
}
```

### Clang C++17
```json
{
    "label": "Clang C++17",
    "type": "shell",
    "command": "clang-cl.exe",
    "args": [
        "-m32",
        "/EHsc",
        "/FC",
        "/Od",
        "/permissive-",
        "/std:c++17",
        "/W4",
        "/Z7",
        "/Fdout/${fileBasenameNoExtension}.pdb",
        "/Foout/",
        "/Feout/${fileBasenameNoExtension}.exe",
        "${file}"
    ],
    "group": "build",
    "presentation": {
        "reveal":"always"
    },
    "problemMatcher": "$msCompile"
}
```

### Clang C++03
```json
{
    "label": "Clang C++03",
    "type": "shell",
    "command": "clang-cl.exe",
    "args": [
        "-m32",
        "/EHsc",
        "/FC",
        "/Od",
        "/permissive-",
        "/W4",
        "/Z7",
        "/Fdout/${fileBasenameNoExtension}.pdb",
        "/Foout/",
        "/Feout/${fileBasenameNoExtension}.exe",
        "${file}"
    ],
    "group": "build",
    "presentation": {
        "reveal":"always"
    },
    "problemMatcher": "$msCompile"
}
```

## Executing and debug

This task should be added to your *launch.json* and will allow you to execut and debug a file build with any of the tasks in the last item.

```json
{
    "name": "Debug current file",
    "type": "cppvsdbg",
    "request": "launch",
    "program": "${workspaceFolder}/out/${fileBasenameNoExtension}.exe",
    "args": [],
    "stopAtEntry": true,
    "cwd": "${workspaceFolder}/out",
    "environment": [],
    "externalConsole": true
}
```

# Building projects

  Using the [CMake](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cmake-tools) extension it will setup the building enviroment for you.

  MSBuild is a different thing, you may have to do some tweaking when building bigger projects but here is the basics:

```json
{
    "label": "MSBuild",
    "command": "msbuild",
    "type": "process",
    "args": [
        "/m",
        "/property:GenerateFullPaths=true",
        "/p:Configuration=Debug;Platform=Win32"
    ],
    "group": "build",
    "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": true,
        "panel": "shared",
        "showReuseMessage": true,
        "clear": true
    },
    "problemMatcher": [
        "$msCompile"
    ]
}
```
